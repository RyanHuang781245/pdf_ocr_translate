<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>OCR Overlay Studio - Editor</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='app.css') }}" />
    <style>
      .topbar-actions a.ghost,
      .topbar-actions button.ghost,
      .topbar-actions button.primary {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        height: 36px;
        padding: 0 14px;
        font-size: 0.9375rem;
        line-height: 1;
      }
    </style>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.2.67/pdf.min.js" referrerpolicy="no-referrer"></script> -->
    <script src="/static/pdfjs/pdf.min.js" referrerpolicy="no-referrer"></script>
  </head>
  <body class="editor" data-job-id="{{ job_id }}">
    <header class="topbar">
      <div>
        <p class="eyebrow">Editing job</p>
        <h1>翻譯編輯</h1>
        <p id="status" class="hint"></p>
      </div>
      <div class="topbar-actions">
        <a class="ghost" href="{{ url_for('main.index') }}">回首頁</a>
        <a id="editedPdfLink" class="ghost" href="#" target="_blank" rel="noopener" style="display:none">預覽已編輯 PDF</a>
        <a class="ghost" href="{{ debug_pdf_url }}" target="_blank" rel="noopener">預覽除錯 PDF</a>
        <button id="batchTranslateBtn" class="ghost">重新翻譯</button>
        <button id="batchRestoreBtn" class="ghost">還原翻譯內容/位置</button>
        <button id="glossaryPromptBtn" class="ghost" type="button">詞彙/提示詞</button>
        <button id="saveBtn" class="primary">儲存編輯</button>
        <button id="downloadBtn" class="ghost">下載已編輯 PDF</button>
      </div>
    </header>
    <main class="workspace">
      <aside class="panel">
        <section>
          <h2>頁面</h2>
          <div class="input-row page-row">
            <button id="prevPage" class="ghost" type="button">上一頁</button>
            <select id="pageSelect"></select>
            <button id="nextPage" class="ghost" type="button">下一頁</button>
            <!-- <select id="pageSelect"></select> -->
          </div>
          <label>
            <span>縮放 (%)</span>
            <div class="input-row">
              <input id="zoomRange" type="range" min="25" max="200" value="50" />
              <input id="zoomNumber" type="number" min="25" max="200" value="50" />
            </div>
          </label>
        </section>
        <section>
          <h2>編輯工具</h2>
          <label>
            <span>字體大小</span>
            <div class="input-row">
              <input id="fontSize" type="range" min="8" max="72" value="16" />
              <input id="fontSizeNumber" type="number" min="8" max="72" value="16" />
            </div>
          </label>
          <label>
            <span>字體顏色</span>
            <input id="fontColor" type="color" value="#0000ff" />
          </label>
          <div class="button-row">
            <button id="addBox" class="ghost">新增文字框</button>
          </div>
          <div class="button-row">
            <button id="copyBox" class="ghost">複製文字框</button>
          </div>
          <div class="button-row">
            <button id="deleteBox" class="danger">刪除文字框</button>
          </div>
        </section>
        
        <section>
          <h2>快捷鍵</h2>
          <p class="hint">
            拖曳文字框移動，拖曳八點調整大小。<br />
            Ctrl + 點選可多選，框選可快速選取。<br />
            多選後可同步調整文字框大小。<br />
            按 Delete 刪除選取的文字框。
          </p>
        </section>
        
      </aside>
      <section class="canvas">
        <div class="viewer">
          <aside class="thumbs">
            <!-- <div class="thumbs-header">Pages</div> -->
            <div id="thumbs" class="thumbs-list"></div>
          </aside>
          <div id="pages" class="pages"></div>
        </div>
      </section>
    </main>
        <div id="glossaryPromptModal" class="modal" hidden>
      <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="glossaryPromptTitle">
        <div class="modal-header">
          <h2 id="glossaryPromptTitle">中英詞彙 / 提示詞</h2>
          <button id="closeGlossaryPrompt" class="ghost" type="button">關閉</button>
        </div>
        <div class="modal-body">
          <section>
            <h3>詞彙對照</h3>
            <div class="input-row">
              <input id="glossaryCn" type="text" placeholder="中文" />
              <input id="glossaryEn" type="text" placeholder="英文" />
            </div>
            <div class="button-row">
              <button id="addGlossaryBtn" class="ghost" type="button">加入詞彙</button>
            </div>
            <div id="glossaryList" class="glossary-list"></div>
          </section>
          <section>
            <h3>翻譯提示詞</h3>
            <label>
              <span>自訂系統提示詞</span>
              <textarea id="systemPrompt" rows="6" placeholder="輸入自訂提示詞（留空則使用預設值）"></textarea>
            </label>
            <div class="button-row">
              <button id="savePromptBtn" class="ghost" type="button">儲存提示詞</button>
            </div>
          </section>
        </div>
      </div>
    </div>
<script src="{{ url_for('static', filename='app.js') }}"></script>
  </body>
</html>
